#!/usr/bin/python

from sys import argv
from getpass import getpass
from base64 import b64encode
from string import maketrans
import hashlib

passphrase = getpass("Enter passphrase: ")

trans_all = maketrans("", "")
length = 16
adjustments = {
        'wP9flncNRpK06Kmd': 15,
        'LoXXhobtGBHpDHUx': 15,
        'f1zkH9w8GXlD1Ftm': 12,
        '2F1b7cg5Ty6JmB8n': 12,
        'VjyRvw22NMkCKklu': 10,
        'L7DSfQrZMLcJUrdi': 12,
        'PMOTa9G5WWGfIJD6': 12,
        'uqUeuvTShkggbtwy': 12,
        '7evDNeAYLmO5lumW': 12,
    }

sha = hashlib.sha512()
sha.update(passphrase + "\n")
for arg in argv[1:]:

    argsha = hashlib.sha512()
    argsha.update("6EBkI317hVLLAJTbhlsBN3inj7BaCXhoT4Dwdhp6KbpVMReJ5bY6TcOVdPxCLfK\n")
    argsha.update(arg)
    hash = b64encode(argsha.digest())
    hash = hash.translate(trans_all, '+/')
    hash = hash[:16]

    length = adjustments.get(hash, length)

    sha.update(arg.lower())

password = b64encode(sha.digest())
password = password.translate(trans_all, '+/')
print password[:length]
